!function(t,n){"use strict";var a=angular.module("adf.widget.Train",["adf.provider","chart.js"]),e=!1,s=null;a.config(["dashboardProvider",function(t){t.widget("Train",{title:"Train",description:"Information sur le remplissage d'un train et controle de l'embarquement",templateUrl:"{widgetsPath}/Train/src/view.html",edit:{templateUrl:"{widgetsPath}/Train/src/edit.html"}})}]),a.controller("TrainWidgetController",["$scope","$http","$rootScope","$filter",function(t,n,a,o){function r(t,n){var e=new SockJS("/sncf");s=Stomp.over(e),s.connect({},function(t){s.subscribe("/topic/update",function(t){var n=JSON.parse(t.body).content;"update"==n&&(c(),updateLastTimestamp(a,o))})})}function i(a){var e="http://localhost:8080/sncf/gares/35000/trains/"+t.config.train+"/"+a;n.get(e).success(function(t,n,a,e){c()}).error(function(t,n,a,e){console.log(n,t)})}function c(){var a="http://localhost:8080/sncf/trains/"+t.config.train;n.get(a).success(function(n,a,s,o){var r=n.embarquesNumber,i=n.buyNumber,c=(n.trainId,n.trainCapacity),l=i-r;t.abord=r,t.voyageurs=i,t.data=[r,l,c-i],e=n.status,e?(t.statusClasse="btn btn-success btn-block",t.statusLabel="Embarquement en cours"):(t.statusClasse="btn btn-danger btn-block",t.statusLabel="Embarquement en attente")})}t.image="src/dismiss.png",t.statusClasse="btn btn-danger btn-block",t.statusLabel="Embarquement en attente",t.status=function(){i(e?"nogo":"go"),e=!e},t.labels=["Voyageurs à bord","Voyageurs à venir","Capacité"],t.colors=["#FD1F5E","#1EF9A1","#050000"],t.options={animateScale:!0,animationEasing:"easeInOutQuart",animationSteps:50},c(),r(t,n),t.connect=function(){r(t,n)},t.disconnect=function(){null!=s&&s.disconnect()},t.send=function(){s.send("/app/hello",{},JSON.stringify({name:"Fred Le Grand"}))}}]),angular.module("adf.widget.Train").run(["$templateCache",function(t){t.put("{widgetsPath}/Train/src/edit.html","<form role=form><div class=form-group><label for=sample>Num&eacute;ro Train</label> <input type=text class=form-control id=sample ng-model=config.train></div></form>"),t.put("{widgetsPath}/Train/src/view.html",'<div ng-controller=TrainWidgetController><button type=button ng-class=statusClasse ng-click=status() id=status>{{statusLabel}}</button><div style=margin-bottom:30px></div><canvas id=doughnut class="chart chart-doughnut" data=data labels=labels colours=colors options=options>test</canvas></div>')}])}(window);