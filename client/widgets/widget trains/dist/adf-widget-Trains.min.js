!function(t,e){"use strict";function i(t,e){var i={};i.type="ColumnChart";var a=t.config.gare,r="http://localhost:8080/sncf/gares/"+a+"/trains";e.get(r).success(function(e,a){200==a&&(i.data={cols:[{id:"train",label:"Train",type:"string"},{id:"validate",label:"Billets Compostes",type:"number"},{id:"buy",label:"A venir",type:"number"},{id:"empty",label:"Vide",type:"number"}],rows:[]},angular.forEach(e,function(t){var e=[];e.push({v:t.id+""}),e.push({v:t.validate});var a=t.tickets-t.validate;e.push({v:a});var r=t.capacity-t.tickets;e.push({v:r}),i.data.rows.push({c:e})}),i.options={title:"Remplissage des trains",isStacked:"true",fill:20,displayExactValues:!0,vAxis:{title:"Nombre des voyageurs",gridlines:{count:6}},hAxis:{title:"Train"}},i.formatters={},t.chart=i)})}var a=angular.module("adf.widget.Trains",["adf.provider","googlechart"]),r=null;a.config(["dashboardProvider",function(t){t.widget("Trains",{title:"Trains",description:"Get trains details.",templateUrl:"{widgetsPath}/Trains/src/view.html",edit:{templateUrl:"{widgetsPath}/Trains/src/edit.html"}})}]),a.controller("TrainsCtrl",["$scope","$http","$rootScope","$filter",function(t,e,a,n){function s(t,e){var s=new SockJS("/sncf");r=Stomp.over(s),r.connect({},function(s){r.subscribe("/topic/trains",function(r){var s=JSON.parse(r.body).content;"update"==s&&(i(t,e),updateLastTimestamp(a,n))})})}i(t,e),s(t,e),t.connect=function(){s(t,e)},t.disconnect=function(){null!=r&&r.disconnect()}}]),angular.module("adf.widget.Trains").run(["$templateCache",function(t){t.put("{widgetsPath}/Trains/src/edit.html","<form role=form><div class=form-group><label for=sample>Gare</label> <input type=text class=form-control id=gare ng-model=config.gare></div></form>"),t.put("{widgetsPath}/Trains/src/view.html","<div ng-controller=TrainsCtrl><div google-chart chart=chart style={{chart.cssStyle}}></div></div>")}])}(window);